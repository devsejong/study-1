= MSA

== API Gateway

. *API Routing*
. Traffic Control
. API Validation
. Auto Failover
. Combine APIs
. Circuit Break
** 일정 트래픽이 넘어갈 때 서비스 break를 검. 예를 들어 사용자에게 "기다려주세요." 메세지를 보여주면서 들어온 순서대로 처리함
** 기술적으로 큐에 넣어서 순차적으로 처리할 수 있음
. 모든 서비스의 API를 처리 중, API Gateway가 죽어버리면 SPOF 발생할 수 있음
** 네트워크 밴드위스가 다차더라도 우회할 수 있도록 레이어 한 단계를 더 처리함
. Netflix Zuul, KONG, AWS APIGateway 등이 있음

== Monolithic Architecture -> MSA

. 비용적인 관점으로 접근하면 안될 것 같음
. 비즈니스를 조금 더 빠르게 개발할 수 있고 테스트 해볼 수 있음
. 개발
** 새로운 개발자가 왔을 때 쉽고 빠르게 시스템을 이해하고 개발할 수 있는가?
** 시스템이 쉽게 변경 가능하고 이해할 수 있는가?
** 개발자들이 배포와 테스트에 대하여 스트레스를 받고 있는가?
. 순서로 보자면 Data 관계 분리 > Data 분리 > 서비스 분리 > 인프라 분리
. 관계되어있는 데이터를 다 조회해서 코드에서 처리해야 되는 문제가 발생하기 때문에 각각 분리된 DB를 모으는 통합 DB를 둬서 해결함

== MSA 장점, 단점

. 장점
** 장애 전파 감소
** 기술 독립성

. 단점
** 트랙잭션 문제가 발생하면 MSA 설계상 잘못된 것이지만, 실제 서비스를 운영하다보면 트랙잭션 문제가 발생하지 않을 수가 없음
*** 대사, 재처리
** Timeout 시, 데이터를 배치로 주기적으로 확인하면서 재처리하던지 롤백처리 할 수 있는 에코시스템을 개발해야함
** 통합 테스트가 어려움
*** 개인 환경 테스트
*** 개발 테스트
*** 통합 테스트
*** 퍼포먼스 테스트

=== MSA 장,단점에 대해 개인적인 생각
. 모노리틱에서 MSA로 넘어가는 과정에서 기존 서비스를 유지하면서 새로운 프로젝트로 넘어간다면 다 옮겨갈때까지 기약없는 야근, 주말 출근을 경험하게 됨
. 트랙잭션 문제는 발생하면 안되지만, 결국 레거시와 새로운 소스에서 트랙잭션 문제가 발생할 수 밖에 없음. 이 문제에 대해 대처방안이 없다면 헬게이트가 열림
. 통합적인 모니터링 시스템이 없다면 이것 또한 헬게이트가 열림
. 타 시스템 도메인이 필요한 테스트에 엮인다면 내가 계획했던 일 이외에도 담당자와 연락하는 일 등 생각외로 관리포인트가 늘어나게 되 피곤해짐
. 결론은 MSA장점보다 단점만 몸소 느끼는 시간이었음
